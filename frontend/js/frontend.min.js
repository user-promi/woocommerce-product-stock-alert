"use strict";jQuery(function(e){function a(a){var t;let s=a.find(".stock-manager-email").val(),i=a.find(".current-product-id").val(),r=a.find(".current-variation-id").val(),o=a.find(".current-product-name").val(),n=localizeData.button_html,c=localizeData.alert_success,l=localizeData.error_occurs,d=localizeData.try_again,u=localizeData.alert_email_exist,p=localizeData.valid_email,m=localizeData.ban_email_domain_text,v=localizeData.ban_email_address_text,f=localizeData.double_opt_in_success,b=localizeData.unsubscribe_button;if(c=(c=c.replace("%product_title%",o)).replace("%customer_email%",s),u=(u=u.replace("%product_title%",o)).replace("%customer_email%",s),(t=s)&&/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(t)){e(this).toggleClass("alert_loader").blur();let h={action:"alert_ajax",nonce:localizeData.nonce,customer_email:s,product_id:i,variation_id:r};localizeData.additional_fields.forEach(a=>{h[a]=e("#stock_manager_"+a).val()}),e.post(localizeData.ajax_url,h,function(t){"0"==t?a.html(`<div class="registered-message"> ${l} <a href="${window.location}"> ${d} </a></div>`):"/*?%already_registered%?*/"==t?a.html(`<div class="registered-message">${u}</div>${b}<input type="hidden" class="subscribed_email" value="${s}" /><input type="hidden" class="product_id" value="${i}" /><input type="hidden" class="variation_id" value="${r}" />`):"/*?%ban_email_address%?*/"==t?a.find(".responsedata-error-message").remove()&&a.append(e(`<p class="responsedata-error-message ban-email-address">${v}</p>`)):"/*?%ban_email_domain%?*/"==t?a.find(".responsedata-error-message").remove()&&a.append(e(`<p class="responsedata-error-message ban-email-address">${m}</p>`)):"/*?%double_opt_in%?*/"==t?a.html(`<div class="registered-message"> ${f}</div>`):a.html(`<div class="registered-message">${c}</div>`),a.find(".notifima-button").replaceWith(n)})}else a.find(".responsedata-error-message").remove()&&a.append(e(`<p style="color:#e2401c;" class="responsedata-error-message">${p}</p>`)),a.find(".notifima-button").replaceWith(n)}e(document).on("click",".notifima-button",function t(s){s.preventDefault();let i=e(this).closest(".stock-notifier-subscribe-form");e(this).text(localizeData.processing),e(this).addClass("stk_disabled");let r=localizeData.recaptcha_enabled;if(r){let o=i.find("#recaptchav3_secretkey").val(),n=i.find("#recaptchav3_response").val(),c={action:"recaptcha_validate_ajax",nonce:localizeData.nonce,recaptcha_secret:o,recaptcha_response:n};e.post(localizeData.ajax_url,c,function(t){t?a(i):(alert("Oops, recaptcha not verified!"),e(this).removeClass("stk_disabled"))})}else a(i)}),e(document).on("click",".unsubscribe-button",function a(t){t.preventDefault();let s=e(this).parent().parent();e(this).text(localizeData.processing),e(this).addClass("stk_disabled");let i={action:"unsubscribe_button",nonce:localizeData.nonce,customer_email:s.find(".subscribed_email").val(),product_id:s.find(".product_id").val(),variation_id:s.find(".variation_id").val()},r=localizeData.alert_unsubscribe_message;r=r.replace("%customer_email%",i.customer_email);let o=localizeData.error_occurs;e.post(localizeData.ajax_url,i,function(a){a?s.html(`<div class="registered-message"> ${r}</div>`):s.html(`<div class="registered-message"> ${o}<a href="${window.location}"> ${localizeData.try_again}</a></div>`),e(this).removeClass("stk_disabled")})}),e(document).on("change","input.variation_id",function a(){let t=Number(e(this).val()),s=Number(e(".stock-notifier-shortcode-subscribe-form").data("product-id"));if(e(".stock-notifier-shortcode-subscribe-form").length&&t){let i={action:"get_variation_box_ajax",nonce:localizeData.nonce,product_id:s,variation_id:t};e.post(localizeData.ajax_url,i,function(a){e(".stock-notifier-shortcode-subscribe-form").html(a)})}else e(".stock-notifier-shortcode-subscribe-form").html("")})});